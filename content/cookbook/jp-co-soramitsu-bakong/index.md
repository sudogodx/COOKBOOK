---
title: üî™ Dissecting the Bakong
tags:
  - android
  - pentest
  - bank
  - writeup
---

> [!danger]
> ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÉ‡∏ô‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏¥‡∏à‡∏≤‡∏Å‡∏ó‡∏≤‡∏á‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ ‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÑ‡∏õ‡∏ó‡∏≥‡∏ï‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ó‡πà‡∏≤‡∏ô‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ú‡∏¥‡∏î‡∏Å‡∏è‡∏´‡∏°‡∏≤‡∏¢ ‡∏û‡∏£‡∏ö. ‡∏ß‡πà‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡πç‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏ó‡∏≤‡∏á‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡∏û.‡∏®. 2560

# üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢

API reverse engineering ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á API Server ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏ò‡∏∏‡∏£‡∏Å‡∏£‡∏£‡∏°‡∏ú‡πà‡∏≤‡∏ô‡∏™‡∏°‡∏≤‡∏£‡πå‡∏ó‡πÇ‡∏ü‡∏ô

# üïµüèª ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡πà‡∏ô

‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÅ‡∏£‡∏Å‡πÄ‡∏£‡∏≤‡∏°‡∏≤‡πÄ‡∏ä‡πá‡∏Ñ lib.so ‡∏Å‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡πà‡∏≤‡∏ï‡∏±‡∏ß‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡πà‡∏ô‡∏ô‡∏≥ lib ‡∏≠‡∏∞‡πÑ‡∏£‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ö‡πâ‡∏≤‡∏á

![[LibChecker.png]]
<p align="center">
    <em>(‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ Lib ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡πÅ‡∏≠‡∏õ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô)</em>
</p>

‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö `libtool-checker.so` ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô Lib ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏£‡∏π‡∏ó‡πÅ‡∏ï‡πà‡πÄ‡∏à‡πâ‡∏≤ RootBeer ‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏ó‡πÅ‡∏•‡πâ‡∏ß‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏õ‡∏Å‡∏ï‡∏¥ (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ã‡πà‡∏≠‡∏ô‡∏£‡∏π‡∏ó ü§®)

# üîç ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏£‡∏≤‡∏ü‡∏ü‡∏¥‡∏Ñ

‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÅ‡∏≠‡∏õ‡∏Å‡∏≤‡∏Å‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏≤‡πÄ‡∏•‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Å‡∏≤‡∏£‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏¢‡∏≠‡∏∞ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏±‡∏Å‡∏ó‡∏£‡∏≤‡∏ü‡∏ü‡∏¥‡∏Ñ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡πÇ‡∏î‡∏¢‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÅ‡∏£‡∏Å‡∏™‡∏∏‡∏î‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏õ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô SSLUnpinning ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡πâ‡∏≤‡∏° SSL ‡πÉ‡∏´‡πâ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤ req, res ‡πÑ‡∏î‡πâ
‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô HTTP Toolkit ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏±‡∏ô‡πÄ‡∏•‡∏¢

![[sniff_01.png]]
<p align="center">
    <em>(‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 2 ‡∏ó‡∏£‡∏≤‡∏ü‡∏ü‡∏¥‡∏Ñ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å)</em>
</p>

![[recovery.png]]
<p align="center">
    <em>(‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 3 QR Code Recovery ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö)</em>
</p>

## Login Request

### Endpoint
- **PATH**: `https://bakong.wingmoney.com/paymentservice/api/bridge/v1/signup/recovery`
- **METHOD**: `POST`

### Header
```http
Accept-Encoding: gzip
Connection: Keep-Alive
Content-Length: 401
Content-Type: application/json; charset=UTF-8
Host: bakong.wingmoney.com
User-Agent: okhttp/4.11.0
```

### Body
```json
{
  "publicKey": "1536b305da9300685796a5e5f339ac8bb57f3048930fe3a9...",
  "requestId": 17502,
  "signature": [
    65, 91, -67, 123, 109, -83, 6, 15, -19, -109, -48, 32, -100, -24, 78, -78,
    -128, -32, -96, 50, -35, -82, 1, 83, -109, 50, 113, 5, ...‡∏Ç‡∏≠‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö
  ],
  "deviceId": "640971a2-8c82-42d4-aed6-..."
}
```

‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡πÅ‡∏õ‡∏•‡∏á QR Code ‡πÄ‡∏õ‡πá‡∏ô Arraylist Integer

```json
{
  "publicKey": "1536b305da9300685796a5e5f339ac8bb57f3048930fe3a94dc915a0efc11c84",
  "requestId": 17502,
  "signature": [
    65, 91, -67, 123, 109, -83, 6, 15, -19, -109, -48, 32, -100, -24, 78, -78,
    -128, -32, -96, 50, -35, -82, 1, 83, -109, 50, 113, 5, -38, 13, -18, -48,
    -104, -45, -116, -47, 67, -87, -100, -35, 123, 41, -99, 80, -108, 11, -98,
    -66, -82, 119, -40, 68, -83, 54, 17, -4, 66, -41, -122, 117, 101, -89, -33, 5
  ],
  "deviceId": "640971a2-8c82-42d4-aed6-8876e47dd72c"
}
```